<form [formGroup]="form">
    <mat-card class="form-card">
        <mat-card-title>
            المخاطر والفرص
        </mat-card-title>
        <mat-card-content>
            <div class="d-flex route-actions mb-5">
                <div [class.active]="activeTab === 1">
                    <span class="d-block circle" (click)="activeTab = 1">
                        1
                    </span>
                    <button mat-button (click)="activeTab = 1">
                        <div>
                            <!-- <i class="fas fa-chart-line"></i> -->
                            <i class="fa fa-file"></i>
                            <p>
                                تعريف الخطر
                            </p>
                            <p>
                                والفرصة
                            </p>
                        </div>
                    </button>
                </div>
                <span class="arrow" [class.active]="activeTab === 1">
                    <span class="line"></span>
                    <i class="fas fa-chevron-left"></i>
                </span>


                 <div [ngClass]="{ disabled: !id, active: activeTab === 2 }">
                    <span class="d-block circle" (click)="activeTab = 2">
                        2
                    </span>
                    <button mat-button (click)="activeTab = 2">
                        <div>
                            <i class="fas fa-chart-line"></i>

                            <p>
                                التحليل
                            </p>
                        </div>
                    </button>
                </div>
                <span class="arrow" [class.active]="activeTab === 2">
                    <span class="line"></span>
                    <i class="fas fa-chevron-left"></i>
                </span>


                 <div [ngClass]="{ disabled: !id, active: activeTab === 3 }">
                    <span class="d-block circle" (click)="activeTab = 3">
                        3
                    </span>
                    <button mat-button (click)="activeTab = 3">
                        <div>
                            <!-- <i class="fas fa-chart-line"></i> -->
                            <i class="fa fa-dna"></i>
                            <p>
                                التقييم
                            </p>
                        </div>
                    </button>
                </div>
                <span class="arrow" [class.active]="activeTab === 3">
                    <span class="line"></span>
                    <i class="fas fa-chevron-left"></i>
                </span>

                 <div [ngClass]="{ disabled: !id, active: activeTab === 4 }">
                    <span class="d-block circle" (click)="activeTab = 4">
                        4
                    </span>
                    <button mat-button (click)="activeTab = 4">
                        <div>
                          <i class="fa fa-arrows-spin"></i>
                            <!-- <i class="fas fa-chart-line"></i> -->
                            <p>
                                المعالجة
                            </p>
                        </div>
                    </button>
                </div>
                <span class="arrow" [class.active]="activeTab === 4">
                    <span class="line"></span>
                    <i class="fas fa-chevron-left"></i>
                </span>

                 <div [ngClass]="{ disabled: !id, active: activeTab === 5 }">
                    <span class="d-block circle" (click)="activeTab = 5">
                      5
                    </span>
                    <button mat-button (click)="activeTab = 5">
                        <div>
                           <i class="fas fa-file-search"></i>
                            <p>
                                المراجعة
                            </p>
                        </div>
                    </button>
                </div>

            </div>

            <div [ngSwitch]="activeTab">
                <app-first  *ngSwitchCase="1" [form]="firstForm"> </app-first>
                <app-second *ngSwitchCase="2" [form]="secondForm"> </app-second>
                <app-third  *ngSwitchCase="3" [form]="thirdForm"> </app-third>
                <app-fourth *ngSwitchCase="4"> </app-fourth>
                <app-fifth  *ngSwitchCase="5" [form]="fifthForm"> </app-fifth>
                <app-first  *ngSwitchDefault  [form]="firstForm"> </app-first>
            </div>
    
        </mat-card-content>
        <mat-card-actions class="d-flex justify-content-between align-items-center">
            <div>
                <button mat-button *ngIf="activeTab > 1" (click)="activeTab = activeTab - 1" class="button green" style="width: auto;">
                    الخطوة السابقة
                </button>
            </div>

            <div>
                <button mat-button class="button red" routerLink="/risks-management/riskopportunity">إلغاء</button>
                <button mat-button class="button blue" type="submit" (click)="submit()">
                    {{ id ? 'حفظ' : 'إضافة'}}
                </button>
            </div>
        </mat-card-actions>
    </mat-card>
</form>

<mat-card *ngIf="id">
    <mat-card-title>
        سجل التغيير
    </mat-card-title>
    <mat-card-content>
        <mat-card-content>
            <ngx-datatable
            class="material fullscreen"
            columnMode="force"
            [headerHeight]="50"
            [footerHeight]="50"
            rowHeight="auto"
            [scrollbarH]="true"
            #dataTable
            [rows]="historyChanges"
            [count]="totalCount"
            [list]="list"
            appNgxdatatable
            >
                <ngx-datatable-column [name]="'::actionName' | abpLocalization" prop="actionName"></ngx-datatable-column>
                <ngx-datatable-column [name]="'::actionDate' | abpLocalization" prop="actionDate">
                    <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                        {{ value | date:'yyyy-MM-dd' }}
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column [name]="'::creatorName' | abpLocalization" prop="creatorName"></ngx-datatable-column>
                <ngx-datatable-column [name]="'::workFlowStages' | abpLocalization" prop="workFlowStagesUser"></ngx-datatable-column>
            </ngx-datatable>
    
        </mat-card-content>
    </mat-card-content>
</mat-card>
